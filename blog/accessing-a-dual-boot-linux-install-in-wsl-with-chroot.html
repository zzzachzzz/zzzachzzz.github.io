<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Accessing a dual boot Linux install in WSL with chroot</title><meta name="next-head-count" content="3"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/069ff64b07ed1af4.css" as="style"/><link rel="stylesheet" href="/_next/static/css/069ff64b07ed1af4.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-eae37baa130ab03a.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-9d21f2f92d74d34f.js" defer=""></script><script src="/_next/static/chunks/pages/_app-0f31e0da3388de53.js" defer=""></script><script src="/_next/static/chunks/792-95b7cdfb484c5ddc.js" defer=""></script><script src="/_next/static/chunks/519-ffc700f401ff0ed5.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-f09ac09cea7069b8.js" defer=""></script><script src="/_next/static/9R7c8DjzDZqMwZqu4ofo-/_buildManifest.js" defer=""></script><script src="/_next/static/9R7c8DjzDZqMwZqu4ofo-/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">html{font-size:16px;min-height:100vh;}/*!sc*/
html,body{height:100%;margin:0;padding:0;}/*!sc*/
@media only screen and (max-device-width:480px){html{font-size:14px;}}/*!sc*/
body{background-color:#3e4d4f;color:white;font-family: -apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}/*!sc*/
*{box-sizing:border-box;}/*!sc*/
h1,h2,h3,h4,h5,h6{font-weight:400;}/*!sc*/
code,code[class*="language-"]{font-family: 'Inconsolata',Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;}/*!sc*/
data-styled.g1[id="sc-global-bLrfTZ1"]{content:"sc-global-bLrfTZ1,"}/*!sc*/
.oXjRv{background-color:#272822;padding:0.2em 0.4em;font-size:0.8em;border-radius:0.3em;color:#ae81ff;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
data-styled.g2[id="A__A_-sc-14fqd0c-0"]{content:"oXjRv,"}/*!sc*/
.hxcnSJ{height:1.534rem;width:1.534rem;padding:0.2em;margin-left:5px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
.hxcnSJ:hover > svg{stroke:#ae81ff;}/*!sc*/
data-styled.g3[id="RssLink___RssLink-sc-lk2wz-0"]{content:"hxcnSJ,"}/*!sc*/
.cbPkmK{height:100%;}/*!sc*/
data-styled.g4[id="RssLink___StyledSvg-sc-lk2wz-1"]{content:"cbPkmK,"}/*!sc*/
.lgEcag{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;font-size:1.2rem;margin:5px;}/*!sc*/
data-styled.g5[id="Navigation__Container-sc-10fffhi-0"]{content:"lgEcag,"}/*!sc*/
.bISkVn{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;-webkit-text-decoration:none;text-decoration:none;gap:5px;}/*!sc*/
data-styled.g6[id="Navigation__Nav-sc-10fffhi-1"]{content:"bISkVn,"}/*!sc*/
.ECCqO{color:white;font-weight:500;line-height:1;}/*!sc*/
data-styled.g7[id="Navigation___StyledSpan-sc-10fffhi-2"]{content:"ECCqO,"}/*!sc*/
.fRlBcp{background-color:#272822;padding:0.2em 0.4em;font-size:0.8em;border-radius:0.3em;}/*!sc*/
data-styled.g8[id="Code-sc-1amjnp4-0"]{content:"fRlBcp,"}/*!sc*/
.cTrNrc{margin-left:auto !important;margin-right:auto !important;}/*!sc*/
data-styled.g9[id="TreeToJSX__Pre-sc-1taxolb-0"]{content:"cTrNrc,"}/*!sc*/
.gacNJW > p{margin:0;}/*!sc*/
data-styled.g11[id="TreeToJSX__Li-sc-1taxolb-2"]{content:"gacNJW,"}/*!sc*/
.gjkXwZ{font-size:1.2em;line-height:1.4em;-webkit-letter-spacing:0.01em;-moz-letter-spacing:0.01em;-ms-letter-spacing:0.01em;letter-spacing:0.01em;overflow-wrap:break-word;padding:1.1em;margin:0 auto;}/*!sc*/
.gjkXwZ > *:not(pre){max-width:850px;margin-left:auto;margin-right:auto;}/*!sc*/
.gjkXwZ > pre{width:90vw;max-width:1100px;}/*!sc*/
data-styled.g14[id="BlogContent__Container-sc-10yyr2o-0"]{content:"gjkXwZ,"}/*!sc*/
.czPvNY{text-align:center;margin:2em;margin-bottom:0.2em;}/*!sc*/
data-styled.g15[id="slug___StyledH-sc-8mhdoa-0"]{content:"czPvNY,"}/*!sc*/
.eAxGCo{font-size:0.9em;text-align:center;}/*!sc*/
data-styled.g16[id="slug___StyledP-sc-8mhdoa-1"]{content:"eAxGCo,"}/*!sc*/
</style><style data-href="https://fonts.googleapis.com/css2?family=Inconsolata&display=swap">@font-face{font-family:'Inconsolata';font-style:normal;font-weight:400;font-stretch:normal;font-display:swap;src:url(https://fonts.gstatic.com/s/inconsolata/v32/QldgNThLqRwH-OJ1UHjlKENVzkWGVkL3GZQmAwLYxYWI2qfdm7Lpp4U8aRk.woff) format('woff')}@font-face{font-family:'Inconsolata';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/inconsolata/v32/QldgNThLqRwH-OJ1UHjlKENVzkWGVkL3GZQmAwLYxYWI2qfdm7Lpp4U8WRL2kXWdycuJDETf.woff) format('woff');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inconsolata';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/inconsolata/v32/QldgNThLqRwH-OJ1UHjlKENVzkWGVkL3GZQmAwLYxYWI2qfdm7Lpp4U8WRP2kXWdycuJDETf.woff) format('woff');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inconsolata';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/inconsolata/v32/QldgNThLqRwH-OJ1UHjlKENVzkWGVkL3GZQmAwLYxYWI2qfdm7Lpp4U8WR32kXWdycuJDA.woff) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div><div class="Navigation__Container-sc-10fffhi-0 lgEcag"><nav class="Navigation__Nav-sc-10fffhi-1 bISkVn"><a href="/" target="_self" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 oXjRv">/</a><span class="Navigation___StyledSpan-sc-10fffhi-2 ECCqO">&gt;</span><a href="/blog" target="_self" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 oXjRv">blog</a><span class="Navigation___StyledSpan-sc-10fffhi-2 ECCqO">&gt;</span><a href="/blog/accessing-a-dual-boot-linux-install-in-wsl-with-chroot" target="_self" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 oXjRv">accessing-a-dual-boot-linux-install-in-wsl-with-chroot</a></nav><a href="/blog/rss.xml" target="_blank" rel="noopener noreferrer" title="RSS Feed" class="A__A_-sc-14fqd0c-0 oXjRv RssLink___RssLink-sc-lk2wz-0 hxcnSJ"><svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round" class="RssLink___StyledSvg-sc-lk2wz-1 cbPkmK"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><circle cx="5" cy="19" r="1"></circle><path d="M4 4a16 16 0 0 1 16 16"></path><path d="M4 11a9 9 0 0 1 9 9"></path></svg></a></div><main><header><h1 class="slug___StyledH-sc-8mhdoa-0 czPvNY">Accessing a dual boot Linux install in WSL with chroot</h1><p class="slug___StyledP-sc-8mhdoa-1 eAxGCo"><time dateTime="2024-10-11T14:49:56.465Z">October 11, 2024</time></p></header><article><div class="BlogContent__Container-sc-10yyr2o-0 gjkXwZ"><p>Got a Windows &amp; Linux dual boot setup? Rather than setting up a new WSL install, wouldn&#x27;t it be nice to be able to &quot;import&quot; your existing native Linux install into WSL? While this method is not exactly an import, it is functionally similar.</p><h2 id="mounting-the-disk-partition">Mounting the disk partition</h2><p>Resources</p><ul><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p><a href="https://learn.microsoft.com/en-us/windows/wsl/wsl2-mount-disk#mounting-a-partitioned-disk" target="_blank" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 oXjRv">WSL 2 - Mounting a partitioned disk</a></p></li><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p><a href="https://www.youtube.com/watch?v=aX1vH1j7m7U" target="_blank" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 oXjRv">EXT4 in Windows - Chris Titus Tech</a></p></li></ul><p>The first step is mounting the partition containing your Linux install. If you only want to access the files of an ext4 partition from Windows, you&#x27;ll only need this step.</p><p>I have defined a couple of PowerShell functions to making mounting and unmounting easier:</p><pre class="TreeToJSX__Pre-sc-1taxolb-0 cTrNrc language-powershell" tabindex="0"><code class="language-powershell"><span class="token comment"># These WSL (un)mount commands must be run in PowerShell as administrator</span>

<span class="token comment"># TODO: Replace the Model string with your own value: 'SHGS31-500GS-2'</span>
<span class="token comment"># TODO: Replace the parition number with your own value: 4</span>

<span class="token keyword">Function</span> linuxmnt <span class="token punctuation">{</span> wsl <span class="token operator">--</span><span class="token function">mount</span> <span class="token punctuation">(</span>gcim <span class="token operator">-</span>query <span class="token string">"SELECT * from Win32_DiskDrive WHERE Model = 'SHGS31-500GS-2'"</span> <span class="token punctuation">|</span> <span class="token function">select</span> <span class="token operator">-</span>expandproperty DeviceID<span class="token punctuation">)</span> <span class="token operator">--</span>partition 4 <span class="token punctuation">}</span>

<span class="token keyword">Function</span> linuxunmnt <span class="token punctuation">{</span> wsl <span class="token operator">--</span>unmount <span class="token punctuation">(</span>gcim <span class="token operator">-</span>query <span class="token string">"SELECT * from Win32_DiskDrive WHERE Model = 'SHGS31-500GS-2'"</span> <span class="token punctuation">|</span> <span class="token function">select</span> <span class="token operator">-</span>expandproperty DeviceID<span class="token punctuation">)</span> <span class="token punctuation">}</span></code></pre><p>The <code class="Code-sc-1amjnp4-0 fRlBcp">linuxmnt</code> function will mount partition 4 of drive 0 in WSL at the mountpoint <code class="Code-sc-1amjnp4-0 fRlBcp">/mnt/wsl/PHYSICALDRIVE0p4</code>. This path will vary based on the drive/device id and partition number you are targeting. The <code class="Code-sc-1amjnp4-0 fRlBcp">linuxunmnt</code> will simply unmount all mountpoints for that drive.</p><p>You can include these in your PowerShell profile so they are always available. Your profile file path can be found with <code class="Code-sc-1amjnp4-0 fRlBcp">echo $profile</code>, which will likely output one of the two following paths, depending on the version of PowerShell you are running:</p><ul><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p><code class="Code-sc-1amjnp4-0 fRlBcp">C:\Users\&lt;your-user&gt;\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1</code></p></li><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p><code class="Code-sc-1amjnp4-0 fRlBcp">C:\Users\&lt;your-user&gt;\Documents\PowerShell\Microsoft.PowerShell_profile.ps1</code></p></li></ul><p>You&#x27;ll need to modify the <code class="Code-sc-1amjnp4-0 fRlBcp">linuxmnt</code> and <code class="Code-sc-1amjnp4-0 fRlBcp">linuxunmnt</code> functions, as I have hardcoded the model (to choose the correct disk) and partition number I need to target.</p><h3 id="determining-the-device-id">Determining the device id</h3><p>Begin by querying for this information in PowerShell:</p><pre class="TreeToJSX__Pre-sc-1taxolb-0 cTrNrc language-powershell" tabindex="0"><code class="language-powershell">> gcim <span class="token operator">-</span>query <span class="token string">"SELECT * from Win32_DiskDrive"</span>
DeviceID           Caption                 Partitions Size          Model
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>           <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>                 <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span>          <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
\\<span class="token punctuation">.</span>\PHYSICALDRIVE0 SHGS31-500GS-2          3          500105249280  SHGS31-500GS-2
\\<span class="token punctuation">.</span>\PHYSICALDRIVE1 WDC WD1003FZEX-00K3CA0  1          1000202273280 WDC WD1003FZEX-00K3CA0
\\<span class="token punctuation">.</span>\PHYSICALDRIVE2 ST2000DM008-2FR102      1          2000396321280 ST2000DM008-2FR102
\\<span class="token punctuation">.</span>\PHYSICALDRIVE3 Samsung SSD 990 EVO 1TB 3          1000202273280 Samsung SSD 990 EVO 1TB</code></pre><p>We target the <code class="Code-sc-1amjnp4-0 fRlBcp">Model</code> attribute rather than <code class="Code-sc-1amjnp4-0 fRlBcp">DeviceID</code>, since the physical drive number can change if hardware is added or removed. Although, in the bash function below we hardcode the path <code class="Code-sc-1amjnp4-0 fRlBcp">/mnt/wsl/PHYSICALDRIVE0p4</code>, physical drive 0. Something to be aware of, which could technically be made dynamic.</p><h3 id="determining-the-partition-number">Determining the partition number</h3><p>To determine the partition number containing the Linux filesystem, we can start with a bare mount, which will make all the drive&#x27;s partitions visible in WSL, but without a mount point.</p><pre class="TreeToJSX__Pre-sc-1taxolb-0 cTrNrc language-powershell" tabindex="0"><code class="language-powershell"><span class="token comment"># Run in PowerShell as administrator</span>
wsl <span class="token operator">--</span><span class="token function">mount</span> \\<span class="token punctuation">.</span>\PHYSICALDRIVEX <span class="token operator">--</span>bare <span class="token comment"># Specify correct id instead of X</span></code></pre><p>After the WSL bare mount, run <code class="Code-sc-1amjnp4-0 fRlBcp">lsblk</code> from WSL.</p><pre class="TreeToJSX__Pre-sc-1taxolb-0 cTrNrc language-none" tabindex="0"><code class="language-none">$ lsblk
NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS
sda      8:0    0 388.4M  1 disk
sdb      8:16   0     2G  0 disk [SWAP]
sdc      8:32   0 465.8G  0 disk
├─sdc1   8:33   0   512M  0 part
├─sdc3   8:35   0   3.7G  0 part
└─sdc4   8:36   0 461.5G  0 part
sdd      8:48   0     1T  0 disk /mnt/wslg/distro
                                 /</code></pre><p>Based on the partition sizes, I can see that <code class="Code-sc-1amjnp4-0 fRlBcp">sdc4</code> is what I&#x27;m looking for, the main ext4 filesystem. If you want to inspect a partition further to verify, you can use <code class="Code-sc-1amjnp4-0 fRlBcp">mount</code> in the usual way to mount its contents to a directory.</p><h2 id="chrooting-into-the-linux-install">Chroot-ing into the Linux install</h2><p>The helper function (named walter because that&#x27;s the hostname that was chosen for the original native install):</p><pre class="TreeToJSX__Pre-sc-1taxolb-0 cTrNrc language-bash" tabindex="0"><code class="language-bash"><span class="token comment"># TODO: Replace PHYSICALDRIVE0p4 with the correct value based on the device id and partition number mounted</span>
<span class="token comment"># TODO: Replace zach with the user you wish to switch to</span>

<span class="token keyword">function</span> <span class="token function-name function">walter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token operator">!</span> -e /mnt/wsl/PHYSICALDRIVE0p4 <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"'/mnt/wsl/PHYSICALDRIVE0p4' does not exist. Did you call linuxmnt?"</span>
    <span class="token builtin class-name">return</span> <span class="token number">1</span>
  <span class="token keyword">fi</span>
  <span class="token function">sudo</span> <span class="token function">mount</span> -t proc /proc /mnt/wsl/PHYSICALDRIVE0p4/proc
  <span class="token function">sudo</span> <span class="token function">mount</span> -t sysfs /sys /mnt/wsl/PHYSICALDRIVE0p4/sys <span class="token operator"><span class="token file-descriptor important">2</span>></span> /dev/null

  <span class="token function">sudo</span> <span class="token function">mount</span> --rbind /dev /mnt/wsl/PHYSICALDRIVE0p4/dev
  <span class="token function">sudo</span> <span class="token function">mount</span> --rbind /mnt /mnt/wsl/PHYSICALDRIVE0p4/mnt
  <span class="token function">sudo</span> <span class="token function">chroot</span> /mnt/wsl/PHYSICALDRIVE0p4/ <span class="token function">su</span> zach
<span class="token punctuation">}</span></code></pre><p>Add the above function to your <code class="Code-sc-1amjnp4-0 fRlBcp">.bashrc</code> or other config file in your WSL install.</p><p>Random note, in my Debian WSL install, when I added a function to the <code class="Code-sc-1amjnp4-0 fRlBcp">.bashrc</code> file, running <code class="Code-sc-1amjnp4-0 fRlBcp">which walter</code> did not find the function, but <code class="Code-sc-1amjnp4-0 fRlBcp">type walter</code> did. More on that <a href="https://unix.stackexchange.com/a/10529" target="_blank" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 oXjRv">here</a>.</p><p>At a minimum, all that&#x27;s really needed is this line, <code class="Code-sc-1amjnp4-0 fRlBcp">sudo chroot /mnt/wsl/PHYSICALDRIVE0p4/ su zach</code>, to choot into the mountpoint and switch from the root user to your regular user.</p><p><code class="Code-sc-1amjnp4-0 fRlBcp">sudo mount --rbind /mnt /mnt/wsl/PHYSICALDRIVE0p4/mnt</code> - This is helpful so that the typical WSL mounts to access the Windows C:\ drive (<code class="Code-sc-1amjnp4-0 fRlBcp">/mnt/c</code>) and any additional drives are accessible.</p><p>The <code class="Code-sc-1amjnp4-0 fRlBcp">/proc</code>, <code class="Code-sc-1amjnp4-0 fRlBcp">/sys</code>, and <code class="Code-sc-1amjnp4-0 fRlBcp">/dev</code> mounts are necessary for certain programs to work. In my case for <code class="Code-sc-1amjnp4-0 fRlBcp">tmux</code>.</p><h2 id="bringing-it-all-together-the-workflow">Bringing it all together: The Workflow</h2><ol><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p>Open PowerShell as Administrator and run <code class="Code-sc-1amjnp4-0 fRlBcp">linuxmnt</code></p></li><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p>Open a terminal for your WSL install, and run <code class="Code-sc-1amjnp4-0 fRlBcp">walter</code> (or whatever you chose to name it).</p></li><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p>You have now chroot&#x27;d into your non-WSL Linux install! You&#x27;ll have access to that shell and your installed programs, kind of as if you had SSH&#x27;d into it.</p></li></ol></div></article></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Accessing a dual boot Linux install in WSL with chroot","date":"2024-10-11T14:49:56.465Z","content":"\nGot a Windows \u0026 Linux dual boot setup? Rather than setting up a new WSL install, wouldn't it be nice to be able to \"import\" your existing native Linux install into WSL? While this method is not exactly an import, it is functionally similar.\n\n## Mounting the disk partition\n\nResources\n- [WSL 2 - Mounting a partitioned disk](https://learn.microsoft.com/en-us/windows/wsl/wsl2-mount-disk#mounting-a-partitioned-disk)\n- [EXT4 in Windows - Chris Titus Tech](https://www.youtube.com/watch?v=aX1vH1j7m7U)\n\nThe first step is mounting the partition containing your Linux install. If you only want to access the files of an ext4 partition from Windows, you'll only need this step.\n\nI have defined a couple of PowerShell functions to making mounting and unmounting easier:\n\n```powershell\n# These WSL (un)mount commands must be run in PowerShell as administrator\n\n# TODO: Replace the Model string with your own value: 'SHGS31-500GS-2'\n# TODO: Replace the parition number with your own value: 4\n\nFunction linuxmnt { wsl --mount (gcim -query \"SELECT * from Win32_DiskDrive WHERE Model = 'SHGS31-500GS-2'\" | select -expandproperty DeviceID) --partition 4 }\n\nFunction linuxunmnt { wsl --unmount (gcim -query \"SELECT * from Win32_DiskDrive WHERE Model = 'SHGS31-500GS-2'\" | select -expandproperty DeviceID) }\n```\n\nThe `linuxmnt` function will mount partition 4 of drive 0 in WSL at the mountpoint `/mnt/wsl/PHYSICALDRIVE0p4`. This path will vary based on the drive/device id and partition number you are targeting. The `linuxunmnt` will simply unmount all mountpoints for that drive.\n\nYou can include these in your PowerShell profile so they are always available. Your profile file path can be found with `echo $profile`, which will likely output one of the two following paths, depending on the version of PowerShell you are running:\n- `C:\\Users\\\u003cyour-user\u003e\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1`\n- `C:\\Users\\\u003cyour-user\u003e\\Documents\\PowerShell\\Microsoft.PowerShell_profile.ps1`\n\nYou'll need to modify the `linuxmnt` and `linuxunmnt` functions, as I have hardcoded the model (to choose the correct disk) and partition number I need to target.\n\n### Determining the device id\n\nBegin by querying for this information in PowerShell:\n\n```powershell\n\u003e gcim -query \"SELECT * from Win32_DiskDrive\"\nDeviceID           Caption                 Partitions Size          Model\n--------           -------                 ---------- ----          -----\n\\\\.\\PHYSICALDRIVE0 SHGS31-500GS-2          3          500105249280  SHGS31-500GS-2\n\\\\.\\PHYSICALDRIVE1 WDC WD1003FZEX-00K3CA0  1          1000202273280 WDC WD1003FZEX-00K3CA0\n\\\\.\\PHYSICALDRIVE2 ST2000DM008-2FR102      1          2000396321280 ST2000DM008-2FR102\n\\\\.\\PHYSICALDRIVE3 Samsung SSD 990 EVO 1TB 3          1000202273280 Samsung SSD 990 EVO 1TB\n```\n\nWe target the `Model` attribute rather than `DeviceID`, since the physical drive number can change if hardware is added or removed. Although, in the bash function below we hardcode the path `/mnt/wsl/PHYSICALDRIVE0p4`, physical drive 0. Something to be aware of, which could technically be made dynamic.\n\n### Determining the partition number\n\nTo determine the partition number containing the Linux filesystem, we can start with a bare mount, which will make all the drive's partitions visible in WSL, but without a mount point.\n\n```powershell\n# Run in PowerShell as administrator\nwsl --mount \\\\.\\PHYSICALDRIVEX --bare # Specify correct id instead of X\n```\n\nAfter the WSL bare mount, run `lsblk` from WSL.\n\n```\n$ lsblk\nNAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS\nsda      8:0    0 388.4M  1 disk\nsdb      8:16   0     2G  0 disk [SWAP]\nsdc      8:32   0 465.8G  0 disk\n├─sdc1   8:33   0   512M  0 part\n├─sdc3   8:35   0   3.7G  0 part\n└─sdc4   8:36   0 461.5G  0 part\nsdd      8:48   0     1T  0 disk /mnt/wslg/distro\n                                 /\n```\n\nBased on the partition sizes, I can see that `sdc4` is what I'm looking for, the main ext4 filesystem. If you want to inspect a partition further to verify, you can use `mount` in the usual way to mount its contents to a directory.\n\n## Chroot-ing into the Linux install\n\nThe helper function (named walter because that's the hostname that was chosen for the original native install):\n\n```bash\n# TODO: Replace PHYSICALDRIVE0p4 with the correct value based on the device id and partition number mounted\n# TODO: Replace zach with the user you wish to switch to\n\nfunction walter() {\n  if [[ ! -e /mnt/wsl/PHYSICALDRIVE0p4 ]]; then\n    echo \"'/mnt/wsl/PHYSICALDRIVE0p4' does not exist. Did you call linuxmnt?\"\n    return 1\n  fi\n  sudo mount -t proc /proc /mnt/wsl/PHYSICALDRIVE0p4/proc\n  sudo mount -t sysfs /sys /mnt/wsl/PHYSICALDRIVE0p4/sys 2\u003e /dev/null\n\n  sudo mount --rbind /dev /mnt/wsl/PHYSICALDRIVE0p4/dev\n  sudo mount --rbind /mnt /mnt/wsl/PHYSICALDRIVE0p4/mnt\n  sudo chroot /mnt/wsl/PHYSICALDRIVE0p4/ su zach\n}\n```\n\nAdd the above function to your `.bashrc` or other config file in your WSL install.\n\nRandom note, in my Debian WSL install, when I added a function to the `.bashrc` file, running `which walter` did not find the function, but `type walter` did. More on that [here](https://unix.stackexchange.com/a/10529).\n\nAt a minimum, all that's really needed is this line, `sudo chroot /mnt/wsl/PHYSICALDRIVE0p4/ su zach`, to choot into the mountpoint and switch from the root user to your regular user.\n\n`sudo mount --rbind /mnt /mnt/wsl/PHYSICALDRIVE0p4/mnt` - This is helpful so that the typical WSL mounts to access the Windows C:\\ drive (`/mnt/c`) and any additional drives are accessible.\n\nThe `/proc`, `/sys`, and `/dev` mounts are necessary for certain programs to work. In my case for `tmux`.\n\n## Bringing it all together: The Workflow\n\n1. Open PowerShell as Administrator and run `linuxmnt`\n2. Open a terminal for your WSL install, and run `walter` (or whatever you chose to name it).\n3. You have now chroot'd into your non-WSL Linux install! You'll have access to that shell and your installed programs, kind of as if you had SSH'd into it.\n\n","slug":"accessing-a-dual-boot-linux-install-in-wsl-with-chroot"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"accessing-a-dual-boot-linux-install-in-wsl-with-chroot"},"buildId":"9R7c8DjzDZqMwZqu4ofo-","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>How I Finally Got Secure Boot Working in Debian</title><meta name="next-head-count" content="3"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/069ff64b07ed1af4.css" as="style"/><link rel="stylesheet" href="/_next/static/css/069ff64b07ed1af4.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-eae37baa130ab03a.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-9d21f2f92d74d34f.js" defer=""></script><script src="/_next/static/chunks/pages/_app-0f31e0da3388de53.js" defer=""></script><script src="/_next/static/chunks/792-95b7cdfb484c5ddc.js" defer=""></script><script src="/_next/static/chunks/519-8d8f13e00821d3ab.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-f09ac09cea7069b8.js" defer=""></script><script src="/_next/static/zzTsSW9q7tXXGEMkt9p4q/_buildManifest.js" defer=""></script><script src="/_next/static/zzTsSW9q7tXXGEMkt9p4q/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">html{font-size:16px;min-height:100vh;}/*!sc*/
html,body{height:100%;margin:0;padding:0;}/*!sc*/
@media only screen and (max-device-width:480px){html{font-size:14px;}}/*!sc*/
body{background-color:#3e4d4f;color:white;font-family: -apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}/*!sc*/
*{box-sizing:border-box;}/*!sc*/
h1,h2,h3,h4,h5,h6{font-weight:400;}/*!sc*/
code,code[class*="language-"]{font-family: 'Inconsolata',Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;}/*!sc*/
data-styled.g1[id="sc-global-bLrfTZ1"]{content:"sc-global-bLrfTZ1,"}/*!sc*/
.oXjRv{background-color:#272822;padding:0.2em 0.4em;font-size:0.8em;border-radius:0.3em;color:#ae81ff;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
data-styled.g2[id="A__A_-sc-14fqd0c-0"]{content:"oXjRv,"}/*!sc*/
.hxcnSJ{height:1.534rem;width:1.534rem;padding:0.2em;margin-left:5px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
.hxcnSJ:hover > svg{stroke:#ae81ff;}/*!sc*/
data-styled.g3[id="RssLink___RssLink-sc-lk2wz-0"]{content:"hxcnSJ,"}/*!sc*/
.cbPkmK{height:100%;}/*!sc*/
data-styled.g4[id="RssLink___StyledSvg-sc-lk2wz-1"]{content:"cbPkmK,"}/*!sc*/
.lgEcag{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;font-size:1.2rem;margin:5px;}/*!sc*/
data-styled.g5[id="Navigation__Container-sc-10fffhi-0"]{content:"lgEcag,"}/*!sc*/
.bISkVn{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;-webkit-text-decoration:none;text-decoration:none;gap:5px;}/*!sc*/
data-styled.g6[id="Navigation__Nav-sc-10fffhi-1"]{content:"bISkVn,"}/*!sc*/
.ECCqO{color:white;font-weight:500;line-height:1;}/*!sc*/
data-styled.g7[id="Navigation___StyledSpan-sc-10fffhi-2"]{content:"ECCqO,"}/*!sc*/
.fRlBcp{background-color:#272822;padding:0.2em 0.4em;font-size:0.8em;border-radius:0.3em;}/*!sc*/
data-styled.g8[id="Code-sc-1amjnp4-0"]{content:"fRlBcp,"}/*!sc*/
.cTrNrc{margin-left:auto !important;margin-right:auto !important;}/*!sc*/
data-styled.g9[id="TreeToJSX__Pre-sc-1taxolb-0"]{content:"cTrNrc,"}/*!sc*/
.bkGieB{color:#aaa;font-style:italic;border-left:2px solid #ddd;margin-left:0;margin-right:0;padding-left:10px;}/*!sc*/
data-styled.g10[id="TreeToJSX__BlockQuote-sc-1taxolb-1"]{content:"bkGieB,"}/*!sc*/
.gacNJW > p{margin:0;}/*!sc*/
data-styled.g11[id="TreeToJSX__Li-sc-1taxolb-2"]{content:"gacNJW,"}/*!sc*/
.epTijp{width:100%;height:100%;object-fit:contain;display:block;}/*!sc*/
data-styled.g12[id="TreeToJSX__Img-sc-1taxolb-3"]{content:"epTijp,"}/*!sc*/
.gjkXwZ{font-size:1.2em;line-height:1.4em;-webkit-letter-spacing:0.01em;-moz-letter-spacing:0.01em;-ms-letter-spacing:0.01em;letter-spacing:0.01em;overflow-wrap:break-word;padding:1.1em;margin:0 auto;}/*!sc*/
.gjkXwZ > *:not(pre){max-width:850px;margin-left:auto;margin-right:auto;}/*!sc*/
.gjkXwZ > pre{width:90vw;max-width:1100px;}/*!sc*/
data-styled.g14[id="BlogContent__Container-sc-10yyr2o-0"]{content:"gjkXwZ,"}/*!sc*/
.czPvNY{text-align:center;margin:2em;margin-bottom:0.2em;}/*!sc*/
data-styled.g15[id="slug___StyledH-sc-8mhdoa-0"]{content:"czPvNY,"}/*!sc*/
.eAxGCo{font-size:0.9em;text-align:center;}/*!sc*/
data-styled.g16[id="slug___StyledP-sc-8mhdoa-1"]{content:"eAxGCo,"}/*!sc*/
</style><style data-href="https://fonts.googleapis.com/css2?family=Inconsolata&display=swap">@font-face{font-family:'Inconsolata';font-style:normal;font-weight:400;font-stretch:normal;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=QldgNThLqRwH-OJ1UHjlKENVzkWGVkL3GZQmAwLYxYWI2qfdm7Lpp4U8aRk&skey=20fa6569a31c71ee&v=v37) format('woff')}@font-face{font-family:'Inconsolata';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=QldgNThLqRwH-OJ1UHjlKENVzkWGVkL3GZQmAwLYxYWI2qfdm7Lpp4U8WRL2kXWdycuJDETf&skey=20fa6569a31c71ee&v=v37) format('woff');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inconsolata';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=QldgNThLqRwH-OJ1UHjlKENVzkWGVkL3GZQmAwLYxYWI2qfdm7Lpp4U8WRP2kXWdycuJDETf&skey=20fa6569a31c71ee&v=v37) format('woff');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inconsolata';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/l/font?kit=QldgNThLqRwH-OJ1UHjlKENVzkWGVkL3GZQmAwLYxYWI2qfdm7Lpp4U8WR32kXWdycuJDA&skey=20fa6569a31c71ee&v=v37) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><div><div class="Navigation__Container-sc-10fffhi-0 lgEcag"><nav class="Navigation__Nav-sc-10fffhi-1 bISkVn"><a href="/" target="_self" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 oXjRv">/</a><span class="Navigation___StyledSpan-sc-10fffhi-2 ECCqO">&gt;</span><a href="/blog" target="_self" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 oXjRv">blog</a><span class="Navigation___StyledSpan-sc-10fffhi-2 ECCqO">&gt;</span><a href="/blog/how-i-finally-got-secure-boot-working-in-debian" target="_self" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 oXjRv">how-i-finally-got-secure-boot-working-in-debian</a></nav><a href="/blog/rss.xml" target="_blank" rel="noopener noreferrer" title="RSS Feed" class="A__A_-sc-14fqd0c-0 oXjRv RssLink___RssLink-sc-lk2wz-0 hxcnSJ"><svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round" class="RssLink___StyledSvg-sc-lk2wz-1 cbPkmK"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><circle cx="5" cy="19" r="1"></circle><path d="M4 4a16 16 0 0 1 16 16"></path><path d="M4 11a9 9 0 0 1 9 9"></path></svg></a></div><main><header><h1 class="slug___StyledH-sc-8mhdoa-0 czPvNY">How I Finally Got Secure Boot Working in Debian</h1><p class="slug___StyledP-sc-8mhdoa-1 eAxGCo"><time dateTime="2025-12-26T14:18:15.800Z">December 26, 2025</time></p></header><article><div class="BlogContent__Container-sc-10yyr2o-0 gjkXwZ"><p><img src="/assets/secure-boot-enabled-mokutil.jpg" alt="sudo mokutil --sb-state SecureBoot enabled" class="TreeToJSX__Img-sc-1taxolb-3 epTijp"/></p><p>TL;DR: <a href="#how-i-did-it" target="_self" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 oXjRv">How I Did It</a></p><h2 id="intro">Intro</h2><p>Secure boot is actually pretty well supported on Debian and other major distros. But complications can arise when:</p><ol><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p>Enabling secure boot later, not during a clean install of the OS</p></li><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p>Using a non-default bootloader (default is typically GRUB)</p></li><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p>Having multiple bootloaders installed</p></li></ol><p>All of the above applied to my situation, making it hard mode.</p><h2 id="background-on-my-weird-setup">Background on My Weird Setup</h2><p>I was single booting Arch + systemd-boot for a while.</p><p>Then I adapted this setup to dual boot Arch &amp; Debian via multiple systemd-boot boot entries.</p><p>When Debian was installed, GRUB got installed too, somehow, despite reusing my boot partition and specifically trying to avoid this.</p><p>Later I removed the Arch installation, and switched to dual booting Debian &amp; Windows. (through multiple UEFI boot entries, couldn&#x27;t quite get it working to launch Windows from systemd-boot)</p><p>I enabled secure boot for a Windows game (League of Legends Vanguard anti-cheat...).</p><p>Now, the problem motivating me to get secure boot working on Debian:
<b>I can&#x27;t boot Debian without first disabling secure boot</b></p><h2 id="terminology">Terminology</h2><ul><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p><b>UEFI/NVRAM boot entries</b> : Boot entries in motherboard menu (firmware level shit) (<code class="Code-sc-1amjnp4-0 fRlBcp">Boot0001</code>, <code class="Code-sc-1amjnp4-0 fRlBcp">Boot0002</code>, etc.)</p></li><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p><b>Bootloader</b> : Software (systemd-boot, GRUB) that loads the OS kernel, acting as the bridge between firmware (UEFI/BIOS) and the OS</p></li><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p><b><a href="https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface" target="_blank" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 oXjRv">UEFI (Unified Extensible Firmware Interface)</a></b> : Modern firmware standard for motherboards, successor to legacy BIOS</p></li><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p><b>EFI (Extensible Firmware Interface)</b> : <code class="Code-sc-1amjnp4-0 fRlBcp">.efi</code> files are UEFI executables, typically bootloaders and shims, placed on the boot partition</p></li><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p><b><a href="https://wiki.archlinux.org/title/EFI_system_partition" target="_blank" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 oXjRv">ESP (EFI System Partition)</a></b> : OS-independent boot partition for UEFI (typically mounted at <code class="Code-sc-1amjnp4-0 fRlBcp">/boot</code>)</p></li><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p><b>Shim</b> : An alternative method of managing accepted Secure Boot keys without touching the UEFI firmware settings. In its simplest configuration, shim will just chainload any EFI executable.</p></li><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p><b>Trixie</b> : Debian 13 Trixie (stable release at time of writing)</p></li><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p><b>Bookworm</b> : Debian 12 Bookworm (oldstable release at time of writing)</p></li></ul><h2 id="debian-docs-and-shim-explained">Debian Docs and Shim Explained</h2><p>I was hopeful when I found this excerpt from the Debian Wiki:</p><blockquote class="TreeToJSX__BlockQuote-sc-1taxolb-1 bkGieB"><p>Starting with Trixie, users of Debian (and of the Debian Installer, since Trixie RC3) can optionally choose to use systemd-boot with shim. The integration point is the systemd-boot package and its postinst/prerm scripts. If GRUB packages are not installed, and both the shim-signed and systemd-boot-efi-[amd64|arm64]-signed packages are installed, then the maintainer scripts will run logic to install the appropriate EFI binaries to the ESP, and to add an EFI boot entry (named Debian) pointing to shim and making it the default entry. If either or both packages are removed, this logic runs in reverse and completely removes the binaries from the ESP, and deletes the EFI boot entry.</p></blockquote><p><a href="https://wiki.debian.org/SecureBoot#Secure_Boot_setup_with_systemd-boot" target="_blank" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 oXjRv">Secure Boot setup with systemd-boot - Debian Wiki</a></p><blockquote class="TreeToJSX__BlockQuote-sc-1taxolb-1 bkGieB"><p>shim is a simple software package that is designed to work as a first-stage bootloader on UEFI systems.</p><p>It was developed by a group of Linux developers from various distros, working together to make Secure Boot work using Free Software. It is a common piece of code that is safe, well-understood and audited so that it can be trusted and signed using platform keys. This means that Microsoft (or other potential firmware CA providers) only have to worry about signing shim, and not all of the other programs that distro vendors might want to support.</p></blockquote><p><a href="https://wiki.debian.org/SecureBoot#Shim" target="_blank" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 oXjRv">Shim - Debian Wiki</a></p><p>In other words, the default secure boot keys on your motherboard firmware that work for Windows secure boot will also work for the shim secure boot. This makes it so you don&#x27;t have to configure custom, non-standard secure boot keys in your motherboard firmware (UEFI).</p><p>Note... shim is not a security bypass that allows secure booting of any arbitrary unsigned EFI. It &quot;Enforces signature verification on whatever it chainloads&quot;.</p><pre class="TreeToJSX__Pre-sc-1taxolb-0 cTrNrc language-none" tabindex="0"><code class="language-none">UEFI firmware
  -&gt; shimx64.efi (Microsoft-signed shim)
     -&gt; verifies next EFI binary (systemd-bootx64.efi, grubx64.efi)
        -&gt; launches it if trusted (Linux kernel)</code></pre><h2 id="how-i-did-it">How I Did It</h2><p><b>Follow the instructions: <a href="https://wiki.debian.org/SecureBoot#Secure_Boot_setup_with_systemd-boot" target="_blank" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 oXjRv">Secure Boot setup with systemd-boot - Debian Wiki</a></b></p><p>In the sections that follow, I&#x27;ll explain where I found the docs lacking, and more detail on what I did.</p><h3 id="why-it-was-not-working-insofar-as-i-can-tell">Why It Was Not Working (Insofar as I Can Tell)</h3><p>I tried following the instructions outlined in the Debian Wiki, and I found them difficult to understand.</p><p>I suspect there&#x27;s one of two reasons it didn&#x27;t work for me initially...</p><h4 id="reason-1-missing">Reason 1: Missing <code class="Code-sc-1amjnp4-0 fRlBcp">systemd-boot-efi-[amd64|arm64]-signed</code></h4><p>I did not first install <code class="Code-sc-1amjnp4-0 fRlBcp">systemd-boot-efi-[amd64|arm64]-signed</code> as instructed:</p><blockquote class="TreeToJSX__BlockQuote-sc-1taxolb-1 bkGieB"><p>If GRUB packages are not installed, and both the shim-signed and systemd-boot-efi-[amd64|arm64]-signed packages are installed, then the maintainer scripts will run logic to install the appropriate EFI binaries to the ESP...</p></blockquote><p>I&#x27;m not really sure why the command to install this is not explicitly included with the other <code class="Code-sc-1amjnp4-0 fRlBcp">apt</code> commands in the doc&#x27;s code blocks. But I addressed this with:</p><pre class="TreeToJSX__Pre-sc-1taxolb-0 cTrNrc language-bash" tabindex="0"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> --reinstall shim-signed systemd-boot-efi-amd64-signed</code></pre><h4 id="reason-2-leftover-grub">Reason 2: Leftover GRUB</h4><p>Maybe I did not do a thorough enough purging of leftover GRUB?</p><blockquote class="TreeToJSX__BlockQuote-sc-1taxolb-1 bkGieB"><p>A user wanting to switch from GRUB to systemd-boot should do so by removing the GRUB packages and installing systemd-boot at the same time, for example on an amd64 system:
<code class="Code-sc-1amjnp4-0 fRlBcp"># apt install --allow-remove-essential systemd-boot grub-efi-amd64-signed-</code></p></blockquote><p>For good measure I did the following to fully remove GRUB:</p><pre class="TreeToJSX__Pre-sc-1taxolb-0 cTrNrc language-bash" tabindex="0"><code class="language-bash"><span class="token comment"># Find all grub packages</span>
<span class="token function">apt</span> list --installed <span class="token operator">|</span> <span class="token function">grep</span> -i grub
<span class="token comment"># Remove em. Your packages may vary, these were mine.</span>
<span class="token function">sudo</span> <span class="token function">apt</span> purge grub-common grub-efi-amd64-bin grub-efi-amd64-unsigned grub-efi-amd64 grub2-common
<span class="token comment"># Other grub artifacts removed</span>
<span class="token comment"># Enter root session `sudo -i` and `cd /boot` partition</span>
<span class="token function">find</span> <span class="token builtin class-name">.</span> -iname <span class="token string">'*grub*'</span>
<span class="token function">rm</span> -r ./grub/</code></pre><h2 id="additional-info">Additional Info</h2><h3 id="cleaning-up-preshim-systemdboot-efis">Cleaning Up Pre-Shim systemd-boot EFIs</h3><p>When I reinstalled one of the systemd-boot packages (probably <code class="Code-sc-1amjnp4-0 fRlBcp">systemd-boot</code>, don&#x27;t remember), I got a message about these files already being present:</p><ul><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p><code class="Code-sc-1amjnp4-0 fRlBcp">/boot/efi/EFI/systemd/systemd-bootx64.efi</code></p></li><li class="TreeToJSX__Li-sc-1taxolb-2 gacNJW"><p><code class="Code-sc-1amjnp4-0 fRlBcp">/boot/efi/EFI/BOOT/BOOTX64.EFI</code></p></li></ul><p>Out of an abundance of caution, I first removed the <code class="Code-sc-1amjnp4-0 fRlBcp">.efi</code> files (perhaps you should back them up somewhere):</p><pre class="TreeToJSX__Pre-sc-1taxolb-0 cTrNrc language-bash" tabindex="0"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">rm</span> /boot/efi/EFI/systemd/systemd-bootx64.efi /boot/efi/EFI/BOOT/BOOTX64.EFI</code></pre><p>And then I reinstalled said systemd-boot packages, just to be sure that the <code class="Code-sc-1amjnp4-0 fRlBcp">.efi</code> files were signed, postinst scripts ran correctly, etc.</p><h3 id="commands-for">Commands for: <code class="Code-sc-1amjnp4-0 fRlBcp">efibootmgr - change the UEFI Boot Manager configuration</code></h3><p>See: <code class="Code-sc-1amjnp4-0 fRlBcp">man efibootmgr</code></p><p>Using <code class="Code-sc-1amjnp4-0 fRlBcp">efibootmgr -v</code>, you can see the UEFI boot entries (<code class="Code-sc-1amjnp4-0 fRlBcp">Boot0001</code>, <code class="Code-sc-1amjnp4-0 fRlBcp">Boot0002</code>, etc.).</p><p>You can supposedly delete boot entries through this interface, but this didn&#x27;t work for me. I think this only deactivated/disabled boot entries: <code class="Code-sc-1amjnp4-0 fRlBcp">sudo efibootmgr -b 0004 -B</code></p><p>Alternatively you can disable unwanted entries in your motherboard&#x27;s UEFI menu.</p><h3 id="set-default-systemdboot-entry-to-current">Set Default systemd-boot Entry to Current</h3><p>Once you have booted into the right systemd-boot entry:</p><pre class="TreeToJSX__Pre-sc-1taxolb-0 cTrNrc language-bash" tabindex="0"><code class="language-bash"><span class="token function">sudo</span> bootctl set-default @current</code></pre><h3 id="verify-secure-boot-enabled-from-linux">Verify Secure Boot Enabled From Linux</h3><pre class="TreeToJSX__Pre-sc-1taxolb-0 cTrNrc language-bash" tabindex="0"><code class="language-bash">$ <span class="token function">sudo</span> mokutil --sb-state
SecureBoot enabled</code></pre><h3 id="get-info-from">Get Info From <code class="Code-sc-1amjnp4-0 fRlBcp">bootctl status</code></h3><p><code class="Code-sc-1amjnp4-0 fRlBcp">sudo bootctl status</code> ouputs lots of info such as:</p><pre class="TreeToJSX__Pre-sc-1taxolb-0 cTrNrc language-none" tabindex="0"><code class="language-none">System:
      Firmware: UEFI 2.70 (American Megatrends 5.19)
 Firmware Arch: x64
   Secure Boot: enabled (user)
  TPM2 Support: yes
  Measured UKI: no
  Boot into FW: supported

...

Available Boot Loaders on ESP:
          ESP: /boot/efi (/dev/disk/by-partuuid/d64202ea-8de9-47d6-947c-11122d0ba571)
         File: ├─/EFI/systemd/systemd-bootx64.efi (systemd-boot 257.9-1~deb13u1)
               ├─/EFI/BOOT/BOOTX64.efi
               └─/EFI/BOOT/fbx64.efi

...

Boot Loaders Listed in EFI Variables:
        Title: Debian
           ID: 0x0003
       Status: active, boot-order
    Partition: /dev/disk/by-partuuid/d64202ea-8de9-47d6-947c-11122d0ba571
         File: └─EFI/DEBIAN/SHIMX64.EFI

... and more!</code></pre></div></article></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"How I Finally Got Secure Boot Working in Debian","date":"2025-12-26T14:18:15.800Z","content":"\n![sudo mokutil --sb-state SecureBoot enabled](/assets/secure-boot-enabled-mokutil.jpg)\n\nTL;DR: [How I Did It](#how-i-did-it)\n\n## Intro\n\nSecure boot is actually pretty well supported on Debian and other major distros. But complications can arise when:\n\n1. Enabling secure boot later, not during a clean install of the OS\n2. Using a non-default bootloader (default is typically GRUB)\n3. Having multiple bootloaders installed\n\nAll of the above applied to my situation, making it hard mode.\n\n## Background on My Weird Setup\n\nI was single booting Arch + systemd-boot for a while.\n\nThen I adapted this setup to dual boot Arch \u0026 Debian via multiple systemd-boot boot entries.\n\nWhen Debian was installed, GRUB got installed too, somehow, despite reusing my boot partition and specifically trying to avoid this.\n\nLater I removed the Arch installation, and switched to dual booting Debian \u0026 Windows. (through multiple UEFI boot entries, couldn't quite get it working to launch Windows from systemd-boot)\n\nI enabled secure boot for a Windows game (League of Legends Vanguard anti-cheat...).\n\nNow, the problem motivating me to get secure boot working on Debian:\n**I can't boot Debian without first disabling secure boot**\n\n## Terminology\n\n- **UEFI/NVRAM boot entries** : Boot entries in motherboard menu (firmware level shit) (`Boot0001`, `Boot0002`, etc.)\n- **Bootloader** : Software (systemd-boot, GRUB) that loads the OS kernel, acting as the bridge between firmware (UEFI/BIOS) and the OS\n- **[UEFI (Unified Extensible Firmware Interface)](https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface)** : Modern firmware standard for motherboards, successor to legacy BIOS\n- **EFI (Extensible Firmware Interface)** : `.efi` files are UEFI executables, typically bootloaders and shims, placed on the boot partition\n- **[ESP (EFI System Partition)](https://wiki.archlinux.org/title/EFI_system_partition)** : OS-independent boot partition for UEFI (typically mounted at `/boot`)\n- **Shim** : An alternative method of managing accepted Secure Boot keys without touching the UEFI firmware settings. In its simplest configuration, shim will just chainload any EFI executable.\n- **Trixie** : Debian 13 Trixie (stable release at time of writing)\n- **Bookworm** : Debian 12 Bookworm (oldstable release at time of writing)\n\n## Debian Docs and Shim Explained\n\nI was hopeful when I found this excerpt from the Debian Wiki:\n\n\u003e Starting with Trixie, users of Debian (and of the Debian Installer, since Trixie RC3) can optionally choose to use systemd-boot with shim. The integration point is the systemd-boot package and its postinst/prerm scripts. If GRUB packages are not installed, and both the shim-signed and systemd-boot-efi-[amd64|arm64]-signed packages are installed, then the maintainer scripts will run logic to install the appropriate EFI binaries to the ESP, and to add an EFI boot entry (named Debian) pointing to shim and making it the default entry. If either or both packages are removed, this logic runs in reverse and completely removes the binaries from the ESP, and deletes the EFI boot entry.\n\n[Secure Boot setup with systemd-boot - Debian Wiki](https://wiki.debian.org/SecureBoot#Secure_Boot_setup_with_systemd-boot)\n\n\u003e shim is a simple software package that is designed to work as a first-stage bootloader on UEFI systems.\n\u003e\n\u003e It was developed by a group of Linux developers from various distros, working together to make Secure Boot work using Free Software. It is a common piece of code that is safe, well-understood and audited so that it can be trusted and signed using platform keys. This means that Microsoft (or other potential firmware CA providers) only have to worry about signing shim, and not all of the other programs that distro vendors might want to support.\n\n[Shim - Debian Wiki](https://wiki.debian.org/SecureBoot#Shim)\n\nIn other words, the default secure boot keys on your motherboard firmware that work for Windows secure boot will also work for the shim secure boot. This makes it so you don't have to configure custom, non-standard secure boot keys in your motherboard firmware (UEFI).\n\nNote... shim is not a security bypass that allows secure booting of any arbitrary unsigned EFI. It \"Enforces signature verification on whatever it chainloads\".\n\n```\nUEFI firmware\n  -\u003e shimx64.efi (Microsoft-signed shim)\n     -\u003e verifies next EFI binary (systemd-bootx64.efi, grubx64.efi)\n        -\u003e launches it if trusted (Linux kernel)\n```\n\n## How I Did It\n\n**Follow the instructions: [Secure Boot setup with systemd-boot - Debian Wiki](https://wiki.debian.org/SecureBoot#Secure_Boot_setup_with_systemd-boot)**\n\nIn the sections that follow, I'll explain where I found the docs lacking, and more detail on what I did.\n\n### Why It Was Not Working (Insofar as I Can Tell)\n\nI tried following the instructions outlined in the Debian Wiki, and I found them difficult to understand.\n\nI suspect there's one of two reasons it didn't work for me initially...\n\n#### Reason 1: Missing `systemd-boot-efi-[amd64|arm64]-signed`\n\nI did not first install `systemd-boot-efi-[amd64|arm64]-signed` as instructed:\n\n\u003e If GRUB packages are not installed, and both the shim-signed and systemd-boot-efi-[amd64|arm64]-signed packages are installed, then the maintainer scripts will run logic to install the appropriate EFI binaries to the ESP...\n\nI'm not really sure why the command to install this is not explicitly included with the other `apt` commands in the doc's code blocks. But I addressed this with:\n\n```bash\nsudo apt install --reinstall shim-signed systemd-boot-efi-amd64-signed\n```\n\n#### Reason 2: Leftover GRUB\n\nMaybe I did not do a thorough enough purging of leftover GRUB?\n\n\u003e A user wanting to switch from GRUB to systemd-boot should do so by removing the GRUB packages and installing systemd-boot at the same time, for example on an amd64 system:\n\u003e `# apt install --allow-remove-essential systemd-boot grub-efi-amd64-signed-`\n\nFor good measure I did the following to fully remove GRUB:\n\n```bash\n# Find all grub packages\napt list --installed | grep -i grub\n# Remove em. Your packages may vary, these were mine.\nsudo apt purge grub-common grub-efi-amd64-bin grub-efi-amd64-unsigned grub-efi-amd64 grub2-common\n# Other grub artifacts removed\n# Enter root session `sudo -i` and `cd /boot` partition\nfind . -iname '*grub*'\nrm -r ./grub/\n```\n\n## Additional Info\n\n### Cleaning Up Pre-Shim systemd-boot EFIs\n\nWhen I reinstalled one of the systemd-boot packages (probably `systemd-boot`, don't remember), I got a message about these files already being present:\n\n- `/boot/efi/EFI/systemd/systemd-bootx64.efi`\n- `/boot/efi/EFI/BOOT/BOOTX64.EFI`\n\nOut of an abundance of caution, I first removed the `.efi` files (perhaps you should back them up somewhere):\n```bash\nsudo rm /boot/efi/EFI/systemd/systemd-bootx64.efi /boot/efi/EFI/BOOT/BOOTX64.EFI\n```\n\nAnd then I reinstalled said systemd-boot packages, just to be sure that the `.efi` files were signed, postinst scripts ran correctly, etc.\n\n### Commands for: `efibootmgr - change the UEFI Boot Manager configuration`\n\nSee: `man efibootmgr`\n\nUsing `efibootmgr -v`, you can see the UEFI boot entries (`Boot0001`, `Boot0002`, etc.).\n\nYou can supposedly delete boot entries through this interface, but this didn't work for me. I think this only deactivated/disabled boot entries: `sudo efibootmgr -b 0004 -B`\n\nAlternatively you can disable unwanted entries in your motherboard's UEFI menu.\n\n### Set Default systemd-boot Entry to Current\n\nOnce you have booted into the right systemd-boot entry:\n\n```bash\nsudo bootctl set-default @current\n```\n\n### Verify Secure Boot Enabled From Linux\n\n```bash\n$ sudo mokutil --sb-state\nSecureBoot enabled\n```\n\n### Get Info From `bootctl status`\n\n`sudo bootctl status` ouputs lots of info such as:\n\n```\nSystem:\n      Firmware: UEFI 2.70 (American Megatrends 5.19)\n Firmware Arch: x64\n   Secure Boot: enabled (user)\n  TPM2 Support: yes\n  Measured UKI: no\n  Boot into FW: supported\n\n...\n\nAvailable Boot Loaders on ESP:\n          ESP: /boot/efi (/dev/disk/by-partuuid/d64202ea-8de9-47d6-947c-11122d0ba571)\n         File: ├─/EFI/systemd/systemd-bootx64.efi (systemd-boot 257.9-1~deb13u1)\n               ├─/EFI/BOOT/BOOTX64.efi\n               └─/EFI/BOOT/fbx64.efi\n\n...\n\nBoot Loaders Listed in EFI Variables:\n        Title: Debian\n           ID: 0x0003\n       Status: active, boot-order\n    Partition: /dev/disk/by-partuuid/d64202ea-8de9-47d6-947c-11122d0ba571\n         File: └─EFI/DEBIAN/SHIMX64.EFI\n\n... and more!\n```\n\n","slug":"how-i-finally-got-secure-boot-working-in-debian"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"how-i-finally-got-secure-boot-working-in-debian"},"buildId":"zzTsSW9q7tXXGEMkt9p4q","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>React Hooks: How to Use useMemo</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/116a9d0d7bbcb7ff8fb6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/116a9d0d7bbcb7ff8fb6.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-c746a4ce4ff8692382cd.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.37f4a736348214b3ca94.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.e810983d220ce60d77fa.js" as="script"/><link rel="preload" href="/_next/static/chunks/d31217defe14a45f21f2dc88a0340a4400241e5c.43128fe35357df1292f1.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-c5083ace283475b900f0.js" as="script"/><link rel="preload" href="/_next/static/chunks/f55490c27d84c973f151130575d86126183b0b6b.3b39966ad3ab6ba53dac.js" as="script"/><link rel="preload" href="/_next/static/chunks/14e8b4443f853547963f3fff4f6d87edb6a6aabe.7f99b8b5b085a064ffe9.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5Bslug%5D-3e90714ce7440c4a9cbd.js" as="script"/><style data-styled="" data-styled-version="5.2.1">html{font-size:16px;min-height:100vh;}/*!sc*/
html,body{height:100%;margin:0;padding:0;}/*!sc*/
@media only screen and (max-device-width:480px){html{font-size:14px;}}/*!sc*/
body{background-color:#3e4d4f;color:white;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen", "Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue", sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}/*!sc*/
*{box-sizing:border-box;}/*!sc*/
h1,h2,h3,h4,h5,h6{font-weight:400;}/*!sc*/
code{font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;}/*!sc*/
data-styled.g1[id="sc-global-bYaKAX1"]{content:"sc-global-bYaKAX1,"}/*!sc*/
.iQzkww{background-color:#272822;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;padding:0.2em 0.4em;font-size:0.8em;border-radius:0.3em;}/*!sc*/
data-styled.g2[id="Code-sc-1amjnp4-0"]{content:"iQzkww,"}/*!sc*/
.kuhBS{background-color:#272822;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;padding:0.2em 0.4em;font-size:0.8em;border-radius:0.3em;color:#ae81ff;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
data-styled.g3[id="A__A_-sc-14fqd0c-0"]{content:"kuhBS,"}/*!sc*/
.frqqeo{margin:5px;}/*!sc*/
data-styled.g6[id="Navigation___StyledLink-sc-10fffhi-0"]{content:"frqqeo,"}/*!sc*/
.fBDDkv{margin:5px;}/*!sc*/
data-styled.g7[id="Navigation___StyledLink2-sc-10fffhi-1"]{content:"fBDDkv,"}/*!sc*/
.gwcSSF{margin:5px;}/*!sc*/
data-styled.g8[id="Navigation___StyledLink3-sc-10fffhi-2"]{content:"gwcSSF,"}/*!sc*/
.hmTGJm{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;font-size:1.2em;-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
data-styled.g9[id="Navigation__Nav-sc-10fffhi-3"]{content:"hmTGJm,"}/*!sc*/
.kjdbIE{margin:5px;color:white;font-weight:500;line-height:1;}/*!sc*/
data-styled.g10[id="Navigation___StyledSpan-sc-10fffhi-4"]{content:"kjdbIE,"}/*!sc*/
.fOgHwq{margin-left:auto !important;margin-right:auto !important;}/*!sc*/
data-styled.g11[id="TreeToJSX__Pre-sc-1taxolb-0"]{content:"fOgHwq,"}/*!sc*/
.jZgmsL{color:#aaa;font-style:italic;border-left:2px solid #ddd;margin-left:0;margin-right:0;padding-left:10px;}/*!sc*/
data-styled.g12[id="TreeToJSX__BlockQuote-sc-1taxolb-1"]{content:"jZgmsL,"}/*!sc*/
.dTmJnK > p{margin:0;}/*!sc*/
data-styled.g13[id="TreeToJSX__Li-sc-1taxolb-2"]{content:"dTmJnK,"}/*!sc*/
.hYmhcO{text-align:center;margin:2em;margin-bottom:0.2em;}/*!sc*/
data-styled.g16[id="slug___StyledH-sc-8mhdoa-0"]{content:"hYmhcO,"}/*!sc*/
.iRnBGj{font-size:0.9em;text-align:center;}/*!sc*/
data-styled.g17[id="slug___StyledP-sc-8mhdoa-1"]{content:"iRnBGj,"}/*!sc*/
.bWFbvA{font-size:1.2em;line-height:1.4em;-webkit-letter-spacing:0.01em;-moz-letter-spacing:0.01em;-ms-letter-spacing:0.01em;letter-spacing:0.01em;overflow-wrap:break-word;padding:1.1em;margin:0 auto;}/*!sc*/
.bWFbvA > *:not(pre){max-width:850px;margin-left:auto;margin-right:auto;}/*!sc*/
.bWFbvA > pre{width:90vw;max-width:1100px;}/*!sc*/
data-styled.g18[id="slug__BlogContentContainer-sc-8mhdoa-2"]{content:"bWFbvA,"}/*!sc*/
</style></head><body><div id="__next"><div><nav class="Navigation__Nav-sc-10fffhi-3 hmTGJm"><a href="/" target="_self" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 kuhBS Navigation___StyledLink-sc-10fffhi-0 frqqeo">/</a><span class="Navigation___StyledSpan-sc-10fffhi-4 kjdbIE">&gt;</span><a href="/blog" target="_self" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 kuhBS Navigation___StyledLink2-sc-10fffhi-1 fBDDkv">blog</a><span class="Navigation___StyledSpan-sc-10fffhi-4 kjdbIE">&gt;</span><a href="/blog/react-hooks-how-to-use-usememo" target="_self" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 kuhBS Navigation___StyledLink3-sc-10fffhi-2 gwcSSF">react-hooks-how-to-use-usememo</a></nav><main><header><h1 class="slug___StyledH-sc-8mhdoa-0 hYmhcO">React Hooks: How to Use useMemo</h1><p class="slug___StyledP-sc-8mhdoa-1 iRnBGj"><time dateTime="2021-03-05T21:29:51.159Z">March 5, 2021</time></p></header><article><div class="slug__BlogContentContainer-sc-8mhdoa-2 bWFbvA"><blockquote class="TreeToJSX__BlockQuote-sc-1taxolb-1 jZgmsL"><p>&quot;In computing, memoization or memoisation is an optimization technique used primarily to speed up computer programs by storing the results of expensive function calls and returning the cached result when the same inputs occur again.&quot;<br/><a href="https://en.wikipedia.org/wiki/Memoization" target="_blank" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 kuhBS">Memoization - Wikipedia</a></p></blockquote><p><code class="Code-sc-1amjnp4-0 iQzkww">useMemo</code> is a hook used to memoize values inside a React component. It&#x27;s a performance optimization to avoid recalculating expensive values on every render. You might be familiar with React&#x27;s <code class="Code-sc-1amjnp4-0 iQzkww">memo</code> function, which is similar, but is used to memoize React components themselves, to avoid said re-renders in the first place.</p><p>The TypeScript function signature of <code class="Code-sc-1amjnp4-0 iQzkww">useMemo</code>:</p><pre class="TreeToJSX__Pre-sc-1taxolb-0 fOgHwq  language-ts"><code class="  language-ts"><span class="token keyword">type</span> <span class="token class-name">useMemo</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token function-variable function">factory</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">T</span><span class="token punctuation">,</span> deps<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">T</span><span class="token punctuation">;</span></code></pre><p>The first argument is a factory function returning the value we want to memoize. Like <code class="Code-sc-1amjnp4-0 iQzkww">useEffect</code> and <code class="Code-sc-1amjnp4-0 iQzkww">useCallback</code>, the second argument to this hook, <code class="Code-sc-1amjnp4-0 iQzkww">deps</code>, is a dependency array. Changes to the values passed to this array will trigger our factory function to rerun, returning a new value. If the values in the dependency array do not change, we&#x27;ll instead receive the memoized value saved during the most recent execution of the factory function.</p><h2>Example</h2><pre class="TreeToJSX__Pre-sc-1taxolb-0 fOgHwq  language-jsx"><code class="  language-jsx"><span class="token keyword">function</span> <span class="token function">Todos</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> todos<span class="token punctuation">,</span> filterByStatus <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> filteredTodos <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> todos<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">todo</span> <span class="token operator">=></span> todo<span class="token punctuation">.</span>status <span class="token operator">===</span> filterByStatus<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> filterByStatus<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>filteredTodos<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">todo<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>todo<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>We receive the props <code class="Code-sc-1amjnp4-0 iQzkww">todos</code>, an array of todo objects, and <code class="Code-sc-1amjnp4-0 iQzkww">filterByStatus</code>, a string indicating the status we want to filter by, such as &#x27;completed&#x27;, &#x27;in-progress&#x27;, etc. If todo objects are added or removed from the <code class="Code-sc-1amjnp4-0 iQzkww">todos</code> array, that will affect the resulting <code class="Code-sc-1amjnp4-0 iQzkww">filteredTodos</code>. Likewise, the result will change if our <code class="Code-sc-1amjnp4-0 iQzkww">filterByStatus</code> changes from &#x27;in-progress&#x27; to &#x27;completed&#x27;. We include both of these variables in the dependency array to signal to <code class="Code-sc-1amjnp4-0 iQzkww">useMemo</code> that changes to these variables should trigger a recalculation of our computed <code class="Code-sc-1amjnp4-0 iQzkww">filteredTodos</code> value.</p><p>Note that for <code class="Code-sc-1amjnp4-0 iQzkww">useMemo</code> to detect that the <code class="Code-sc-1amjnp4-0 iQzkww">todos</code> array is unchanged between renders, it must be equal by reference. The variables included in the dependency array will be compared to their previous values using strict equality (<code class="Code-sc-1amjnp4-0 iQzkww">===</code>). Remember that arrays, objects, and functions are only equal by reference:</p><pre class="TreeToJSX__Pre-sc-1taxolb-0 fOgHwq  language-js"><code class="  language-js"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment">// false</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
x <span class="token operator">===</span> x <span class="token comment">// true;</span></code></pre><p>Using our example with the <code class="Code-sc-1amjnp4-0 iQzkww">todos</code> array prop, if that prop comes from a parent component storing the value as state:</p><pre class="TreeToJSX__Pre-sc-1taxolb-0 fOgHwq  language-js"><code class="  language-js"><span class="token keyword">const</span> <span class="token punctuation">[</span>todos<span class="token punctuation">,</span> setTodos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>...then <code class="Code-sc-1amjnp4-0 iQzkww">todos</code> will remain referentially equal <i>until</i> <code class="Code-sc-1amjnp4-0 iQzkww">setTodos</code> is called. You can test this out for yourself, by placing a <code class="Code-sc-1amjnp4-0 iQzkww">console.log</code> statement inside your <code class="Code-sc-1amjnp4-0 iQzkww">useMemo</code>&#x27;s factory function, to see when it is triggered.</p><p><code class="Code-sc-1amjnp4-0 iQzkww">useMemo</code> has a lot of concepts in common with <code class="Code-sc-1amjnp4-0 iQzkww">useEffect</code> and <code class="Code-sc-1amjnp4-0 iQzkww">useCallback</code>, and yet, at least to me, <code class="Code-sc-1amjnp4-0 iQzkww">useMemo</code> is a lot easier to understand. Perhaps that&#x27;s because it seems less intuitive to memoize functions, in the case of <code class="Code-sc-1amjnp4-0 iQzkww">useEffect</code> and <code class="Code-sc-1amjnp4-0 iQzkww">useCallback</code>.</p><p>For a more detailed explanation of the dependency array, and other related concepts, you can check out:</p><ul><li class="TreeToJSX__Li-sc-1taxolb-2 dTmJnK"><p>My post on useEffect: <a href="/blog/react-hooks-how-to-use-useeffect" target="_self" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 kuhBS">React Hooks: How to Use useEffect</a></p></li><li class="TreeToJSX__Li-sc-1taxolb-2 dTmJnK"><p><a href="https://www.benmvp.com/blog/object-array-dependencies-react-useEffect-hook" target="_blank" rel="noopener noreferrer" class="A__A_-sc-14fqd0c-0 kuhBS">Object &amp; array dependencies in the React useEffect Hook</a></p></li></ul></div></article></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"React Hooks: How to Use useMemo","date":"2021-03-05T21:29:51.159Z","content":"\n\u003e\"In computing, memoization or memoisation is an optimization technique used primarily to speed up computer programs by storing the results of expensive function calls and returning the cached result when the same inputs occur again.\"  \n[Memoization - Wikipedia](https://en.wikipedia.org/wiki/Memoization)\n\n`useMemo` is a hook used to memoize values inside a React component. It's a performance optimization to avoid recalculating expensive values on every render. You might be familiar with React's `memo` function, which is similar, but is used to memoize React components themselves, to avoid said re-renders in the first place.\n\nThe TypeScript function signature of `useMemo`:\n\n```ts\ntype useMemo = \u003cT\u003e(factory: () =\u003e T, deps: Array\u003cany\u003e) =\u003e T;\n```\n\nThe first argument is a factory function returning the value we want to memoize. Like `useEffect` and `useCallback`, the second argument to this hook, `deps`, is a dependency array. Changes to the values passed to this array will trigger our factory function to rerun, returning a new value. If the values in the dependency array do not change, we'll instead receive the memoized value saved during the most recent execution of the factory function.\n\n## Example\n```jsx\nfunction Todos({ todos, filterByStatus }) {\n  const filteredTodos = useMemo(() =\u003e {\n    return todos.filter(todo =\u003e todo.status === filterByStatus);\n  }, [todos, filterByStatus]);\n\n  return (\n    \u003cul\u003e\n      {filteredTodos.map((todo, i) =\u003e\n        \u003cli key={i}\u003e{todo.name}\u003c/li\u003e\n      )}\n    \u003c/ul\u003e\n  );\n}\n```\n\nWe receive the props `todos`, an array of todo objects, and `filterByStatus`, a string indicating the status we want to filter by, such as 'completed', 'in-progress', etc. If todo objects are added or removed from the `todos` array, that will affect the resulting `filteredTodos`. Likewise, the result will change if our `filterByStatus` changes from 'in-progress' to 'completed'. We include both of these variables in the dependency array to signal to `useMemo` that changes to these variables should trigger a recalculation of our computed `filteredTodos` value.\n\nNote that for `useMemo` to detect that the `todos` array is unchanged between renders, it must be equal by reference. The variables included in the dependency array will be compared to their previous values using strict equality (`===`). Remember that arrays, objects, and functions are only equal by reference:\n```js\n[1, 2, 3] === [1, 2, 3] // false\nlet x = [1, 2, 3];\nx === x // true;\n```\n\nUsing our example with the `todos` array prop, if that prop comes from a parent component storing the value as state:\n```js\nconst [todos, setTodos] = useState([]);\n```\n...then `todos` will remain referentially equal _until_ `setTodos` is called. You can test this out for yourself, by placing a `console.log` statement inside your `useMemo`'s factory function, to see when it is triggered.\n\n`useMemo` has a lot of concepts in common with `useEffect` and `useCallback`, and yet, at least to me, `useMemo` is a lot easier to understand. Perhaps that's because it seems less intuitive to memoize functions, in the case of `useEffect` and `useCallback`.\n\nFor a more detailed explanation of the dependency array, and other related concepts, you can check out:\n* My post on useEffect: [React Hooks: How to Use useEffect](/blog/react-hooks-how-to-use-useeffect)\n* [Object \u0026 array dependencies in the React useEffect Hook](https://www.benmvp.com/blog/object-array-dependencies-react-useEffect-hook)\n\n","slug":"react-hooks-how-to-use-usememo"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"react-hooks-how-to-use-usememo"},"buildId":"xjTf5Jpp68g78TlIWcdNE","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-28654a8145d7603786fc.js"></script><script src="/_next/static/chunks/main-c746a4ce4ff8692382cd.js" async=""></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.37f4a736348214b3ca94.js" async=""></script><script src="/_next/static/chunks/commons.e810983d220ce60d77fa.js" async=""></script><script src="/_next/static/chunks/d31217defe14a45f21f2dc88a0340a4400241e5c.43128fe35357df1292f1.js" async=""></script><script src="/_next/static/chunks/pages/_app-c5083ace283475b900f0.js" async=""></script><script src="/_next/static/chunks/f55490c27d84c973f151130575d86126183b0b6b.3b39966ad3ab6ba53dac.js" async=""></script><script src="/_next/static/chunks/14e8b4443f853547963f3fff4f6d87edb6a6aabe.7f99b8b5b085a064ffe9.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-3e90714ce7440c4a9cbd.js" async=""></script><script src="/_next/static/xjTf5Jpp68g78TlIWcdNE/_buildManifest.js" async=""></script><script src="/_next/static/xjTf5Jpp68g78TlIWcdNE/_ssgManifest.js" async=""></script></body></html>